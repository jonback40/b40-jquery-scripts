!function(t,i,o){"use strict";var s=function(s,n,e){this.$element=t(s),this.options=e,this.$document=t(i),this.$window=t(o).on("scroll",t.proxy(this._update,this)).on("resize",t.proxy(this._updateWindow,this)),this.documentHeight=0,this.windowHeight=0,this.scrollTop=0,this.scrollBottom=0,this.scrollProgress=0,this.duration=0,this.destination=n,this.destinationMapper=function(){},this.$target=null,this.targetOffset=0,this.targetMapper=function(){},this.focalPoint=0,this.focalPointMapper=function(){},this._hasCalled=!1,this.init()};s.NAMESPACE="b40.reach",s.DEFAULTS={before:function(){},after:function(){},persist:!1,persistBefore:!1,persistAfter:!1,focalPoint:"top"},s.prototype={init:function(){var t=typeof this.destination;switch("object"==t?(this.$target=this.destination,this.destinationMapper=this._mapFromElement):"number"==t?this.destinationMapper=this._mapFromNumber:"string"==t&&/^\d{0,2}%$/.test(this.destination)?(this.destination=parseInt(this.destination),this.destinationMapper=this._mapFromPercent):"function"==t&&(this.targetMapper=this.destination,this.destinationMapper=this._mapFromFunction),this.options.focalPoint){case"top":this.focalPointMapper=this._mapFromTop;break;case"bottom":this.focalPointMapper=this._mapFromBottom;break;default:this.focalPointMapper=this.options.focalPoint}this.$window.trigger("resize")},_setScrollTop:function(){this.scrollTop=this.$window.scrollTop()},_setScrollBottom:function(){this.scrollBottom=this.scrollTop+this.windowHeight},_setFocalPoint:function(){this.focalPoint=this.focalPointMapper()},_setProgress:function(){this.scrollProgress=Math.round(this.scrollTop/this.duration*100)},_setDuration:function(){this.duration=this.documentHeight-this.windowHeight},_getCallbackData:function(){return{position:this.scrollTop,progress:this.scrollProgress,duration:this.duration}},_mapFromTop:function(){return this.scrollTop},_mapFromBottom:function(){return this.scrollBottom},_mapFromElement:function(t){return t.focalPoint>=t.targetOffset},_mapFromNumber:function(t){return t.focalPoint>=t.destination},_mapFromPercent:function(t){return t.scrollProgress>=t.destination},_mapFromFunction:function(t,i,o){return this.targetMapper.call(i,o)},_updateWindow:function(){this.documentHeight=this.$document.height(),this.windowHeight=this.$window.height(),this.targetOffset=this.$target?Math.round(this.$target.offset().top):0,this._setScrollTop(),this._setScrollBottom(),this._setFocalPoint(),this._setDuration(),this._setProgress(),this._update()},_hasReached:function(t,i){return this.destinationMapper(this,t,i)},_notify:function(i,o,s,n,e){o=t.proxy(o,i,s),this._hasCalled===n?(this.options.persist||e)&&o():(this._hasCalled=n,o())},_update:function(){this._setScrollTop(),this._setScrollBottom(),this._setProgress(),this._setFocalPoint();var t=this,i=this._getCallbackData();return this.$element.each(function(){t._hasReached(this,i)?t._notify(this,t.options.after,i,!0,t.options.persistAfter):t._notify(this,t.options.before,i,!1,t.options.persistBefore)})}};var n=s,e="reach",r=t.fn[e];t.fn[e]=function(i,o){return 1==arguments.length&&(o=i,i=null),"function"==typeof o&&(o={after:o}),this.each(function(){var e;e=null==i?this.ownerDocument?t(this):0:i;var r=t(this),h=r.data(n.NAMESPACE),a=t.extend({},n.DEFAULTS,"object"==typeof o&&o);h||r.data(n.NAMESPACE,h=new s(this,e,a))})},t.fn[e].Constructor=n,t.fn[e].noConflict=function(){return t.fn[e]=r,this}}($,document,window);